{"version":3,"file":"index.min.js","sources":["index.js"],"sourcesContent":["import { useState, useCallback, useEffect } from \"react\";\n\nfunction useGlobalStore(name) {\n    return useGlobalStoreold({\n        [name]: \"\"\n    })[name];\n}\n\nfunction isfunction(a) {\n    return \"function\" === typeof a;\n}\n\nfunction changeState(keyname, newvalue) {\n    const key = keyname;\n    const eventname = key;\n    let newstate = newvalue;\n    const oldstate = simpleglobalstatestore[key];\n    const state = oldstate;\n    if (isfunction(newstate)) {\n        newstate = newstate.call(undefined, state);\n    }\n    if (isinvalidstate(newstate)) {\n        throw Error(\"invalid state\");\n    }\n    if (!jsondeepequal(newstate, state)) {\n        simpleglobalstatestore[key] = jsonparsestringify(newstate);\n        console.log(\"\\u5168\\u5c40\\u72b6\\u6001\\u6539\\u53d8\", simpleglobalstatestore);\n        temptarget.dispatchEvent(new Event(eventname));\n    }\n}\n\nfunction jsonparsestringify(o) {\n    return JSON.parse(JSON.stringify(o));\n}\n\nfunction getGlobalStates() {\n    return newobjjson(simpleglobalstatestore);\n}\n\nfunction jsondeepequal(a, b) {\n    return JSON.stringify(a) === JSON.stringify(b);\n}\n\nfunction isinvalidstate(newstate) {\n    return \"undefined\" === typeof newstate || isfunction(newstate) || newstate === null || \"symbol\" === typeof newstate;\n}\n\nconst temptarget = new EventTarget;\n\nconst simpleglobalstatestore = {};\n\nfunction newobjjson(obj) {\n    if (typeof obj !== \"object\") {\n        throw new TypeError(\"The argument passed in must be an 'object' type!\");\n    }\n    return jsonparsestringify(obj);\n}\n\nfunction isplainobject(o) {\n    return typeof o === \"object\" && Object.prototype.toString.call(o) === \"[object Object]\";\n}\n\nfunction useGlobalStoreold(jsonobject) {\n    if (!isplainobject(jsonobject)) {\n        throw Error(\"invalid object\");\n    }\n    const newjsonobj = newobjjson(jsonobject);\n    const newobjtoreturn = {};\n    Object.keys(newjsonobj).forEach(key => {\n        const eventname = key;\n        if (\"undefined\" === typeof simpleglobalstatestore[key]) {\n            simpleglobalstatestore[key] = newjsonobj[key];\n        }\n        const initialstate = \"undefined\" !== typeof simpleglobalstatestore[key] ? simpleglobalstatestore[key] : newjsonobj[key];\n        if (isinvalidstate(initialstate)) {\n            throw Error(\"invalid state\");\n        }\n        const [state, setstate] = useState(jsonparsestringify(initialstate));\n        const eventhandler = useCallback(() => {\n            const newstate = simpleglobalstatestore[key];\n            if (!jsondeepequal(newstate, state)) setstate(jsonparsestringify(newstate));\n        }, []);\n        useEffect(() => {\n            temptarget.addEventListener(eventname, eventhandler);\n            temptarget.dispatchEvent(new Event(eventname));\n            return () => {\n                temptarget.removeEventListener(eventname, eventhandler);\n            };\n        }, []);\n        newobjtoreturn[key] = [ state, newstate => {\n            if (isfunction(newstate)) {\n                newstate = newstate.call(undefined, state);\n            }\n            if (isinvalidstate(newstate)) {\n                throw Error(\"invalid state\");\n            }\n            if (!jsondeepequal(newstate, state)) {\n                simpleglobalstatestore[key] = jsonparsestringify(newstate);\n                console.log(\"\\u5168\\u5c40\\u72b6\\u6001\\u6539\\u53d8\", simpleglobalstatestore);\n                temptarget.dispatchEvent(new Event(eventname));\n            }\n        } ];\n    });\n    return newobjtoreturn;\n}\n\nfunction initGlobalState(jsonobject) {\n    if (!isplainobject(jsonobject)) {\n        throw Error(\"invalid object\");\n    }\n    const newjsonobj = newobjjson(jsonobject);\n    const newobjtoreturn = {};\n    Object.keys(newjsonobj).forEach(key => {\n        if (\"undefined\" === typeof simpleglobalstatestore[key]) {\n            simpleglobalstatestore[key] = newjsonobj[key];\n        }\n        newobjtoreturn[key] = simpleglobalstatestore[key];\n    });\n    console.log(\"\\u5168\\u5c40\\u72b6\\u6001\\u751f\\u6210\", simpleglobalstatestore);\n    return newobjtoreturn;\n}\n\nexport { changeState, getGlobalStates, initGlobalState, useGlobalStore };\n//# sourceMappingURL=index.js.map\n"],"names":["useGlobalStore","name","jsonobject","isplainobject","Error","newjsonobj","newobjjson","newobjtoreturn","Object","keys","forEach","key","eventname","simpleglobalstatestore","initialstate","isinvalidstate","state","setstate","useState","jsonparsestringify","eventhandler","useCallback","newstate","jsondeepequal","useEffect","temptarget","addEventListener","dispatchEvent","Event","removeEventListener","isfunction","call","undefined","useGlobalStoreold","[object Object]","a","changeState","keyname","newvalue","o","JSON","parse","stringify","getGlobalStates","b","EventTarget","obj","TypeError","prototype","toString","initGlobalState"],"mappings":"iEAEA,SAASA,EAAeC,GACpB,OA2DJ,SAA2BC,GACvB,IAAKC,EAAcD,GACf,MAAME,MAAM,kBAEhB,MAAMC,EAAaC,EAAWJ,GACxBK,EAAiB,GAoCvB,OAnCAC,OAAOC,KAAKJ,GAAYK,QAAQC,IAC5B,MAAMC,EAAYD,OACd,IAAuBE,EAAuBF,KAC9CE,EAAuBF,GAAON,EAAWM,IAE7C,MAAMG,OAAe,IAAuBD,EAAuBF,GAAOE,EAAuBF,GAAON,EAAWM,GACnH,GAAII,EAAeD,GACf,MAAMV,MAAM,iBAEhB,MAAOY,EAAOC,GAAYC,EAASC,EAAmBL,IAChDM,EAAeC,EAAY,KAC7B,MAAMC,EAAWT,EAAuBF,GACnCY,EAAcD,EAAUN,IAAQC,EAASE,EAAmBG,KAClE,IACHE,EAAU,KACNC,EAAWC,iBAAiBd,EAAWQ,GACvCK,EAAWE,cAAc,IAAIC,MAAMhB,IAC5B,KACHa,EAAWI,oBAAoBjB,EAAWQ,KAE/C,IACHb,EAAeI,GAAO,CAAEK,EAAOM,IAI3B,GAHIQ,EAAWR,KACXA,EAAWA,EAASS,UAAKC,EAAWhB,IAEpCD,EAAeO,GACf,MAAMlB,MAAM,iBAEXmB,EAAcD,EAAUN,KACzBH,EAAuBF,GAAOQ,EAAmBG,GAEjDG,EAAWE,cAAc,IAAIC,MAAMhB,SAIxCL,EApGA0B,CAAkB,CACrBC,CAACjC,GAAO,KACTA,GAGP,SAAS6B,EAAWK,GAChB,MAAO,mBAAsBA,EAGjC,SAASC,EAAYC,EAASC,GAC1B,MAAM3B,EAAM0B,EACNzB,EAAYD,EAClB,IAAIW,EAAWgB,EACf,MACMtB,EADWH,EAAuBF,GAKxC,GAHImB,EAAWR,KACXA,EAAWA,EAASS,UAAKC,EAAWhB,IAEpCD,EAAeO,GACf,MAAMlB,MAAM,iBAEXmB,EAAcD,EAAUN,KACzBH,EAAuBF,GAAOQ,EAAmBG,GAEjDG,EAAWE,cAAc,IAAIC,MAAMhB,KAI3C,SAASO,EAAmBoB,GACxB,OAAOC,KAAKC,MAAMD,KAAKE,UAAUH,IAGrC,SAASI,IACL,OAAOrC,EAAWO,GAGtB,SAASU,EAAcY,EAAGS,GACtB,OAAOJ,KAAKE,UAAUP,KAAOK,KAAKE,UAAUE,GAGhD,SAAS7B,EAAeO,GACpB,YAAO,IAAuBA,GAAYQ,EAAWR,IAA0B,OAAbA,GAAqB,iBAAoBA,EAG/G,MAAMG,EAAa,IAAIoB,YAEjBhC,EAAyB,GAE/B,SAASP,EAAWwC,GAChB,GAAmB,iBAARA,EACP,MAAM,IAAIC,UAAU,oDAExB,OAAO5B,EAAmB2B,GAG9B,SAAS3C,EAAcoC,GACnB,MAAoB,iBAANA,GAAwD,oBAAtC/B,OAAOwC,UAAUC,SAASlB,KAAKQ,GA+CnE,SAASW,EAAgBhD,GACrB,IAAKC,EAAcD,GACf,MAAME,MAAM,kBAEhB,MAAMC,EAAaC,EAAWJ,GACxBK,EAAiB,GAQvB,OAPAC,OAAOC,KAAKJ,GAAYK,QAAQC,SACxB,IAAuBE,EAAuBF,KAC9CE,EAAuBF,GAAON,EAAWM,IAE7CJ,EAAeI,GAAOE,EAAuBF,KAG1CJ"}